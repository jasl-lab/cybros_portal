<div class="row">
  <div class="col-12"
    data-controller="crm-year-report"
    data-action="resize@window->crm-year-report#layout"
    data-crm-year-report-x_axis="<%= @years.to_json -%>"
    data-crm-year-report-top20s="<%= @top20s.to_json -%>"
    data-crm-year-report-top20to50s="<%= @top20to50s.to_json -%>"
    data-crm-year-report-gt50s="<%= @gt50s.to_json -%>"
    data-crm-year-report-others="<%= @others.to_json -%>">
    <h3 class="page-title">
      <%= t(".title") %>
    </h3>
    <%= form_tag report_crm_year_report_path, method: :get, class: 'form-inline' do -%>
      <div class="form-group mr-1">
        <label class="mr-1"><%= t(".org_names") -%>ï¼š</label>
        <%= select_tag 'orgs', options_for_select(@organization_options, @orgs_options), { include_blank: true, multiple: true, class: 'form-control' } %>
      </div>
      <div><%= submit_tag t(".confirm"), class: 'btn btn-thape-color' %></div>
    <% end -%>
  </div>
  <div class="col-6">
    <div id="crm-year-report-chart" style="width: 100%;height: 500px;">
    </div>
  </div>
  <div class="col-6 table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th></th>
          <th><%= t('.table.top20') -%></th>
          <th><%= t('.table.top20to50') -%></th>
          <th><%= t('.table.gt50') -%></th>
          <th><%= t('.table.other') -%></th>
          <th><%= t('.table.total') -%></th>
        </tr>
      </thead>
      <tbody>
        <% @data.each do |d| %>
          <tr>
            <td><%= d.year -%></td>
            <td><%= (d.top20 / 100_0000.0).round(1) -%></td>
            <td><%= (d.top20to50 / 100_0000.0).round(1) -%></td>
            <td><%= (d.gt50 / 100_0000.0).round(1) -%></td>
            <td><%= (d.others / 100_0000.0).round(1) -%></td>
            <td><%= ((d.top20+d.top20to50+d.gt50+d.others) / 100_0000.0).round(1) -%></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<div id="crm-year-report-modal" class="modal" tabindex="-1" role="dialog"></div>
