<div class="row">
  <div class="col-lg-12">
    <h3 class="page-title">
      <%= t(".title") %>
    </h3>
    <%= form_tag cost_split_human_resources_path, method: :get, class: 'form-inline' do -%>
      <div class="form-group">
        <label class="mr-1"><%= t(".company_name") -%>：</label>
        <%= select_tag 'company_name', options_for_select(@all_company_names, @company_name), class: 'form-control-plaintext form-control', data: { remote: true, type: :script, url: url_for(controller: 'cost_split/human_resources', action: 'change_company', format: 'js')} -%>
      </div>
      <div class="form-group mr-3">
        <label class="mr-1"><%= t(".dept_name") -%>：</label>
          <%= select_tag 'depts', options_for_select(@dept_options, @depts), { id: 'hr-depts-select', include_blank: true, multiple: true, class: 'form-control' } %>
      </div>
      <div><%= submit_tag t(".confirm"), class: 'btn btn-primary' %></div>
    <% end -%>

    <div class="row">
      <div class="col-lg-12">
        <table class="table table-bordered table-responsive">
          <thead>
            <tr>
              <th><%= t(".table.clerk_code") -%></th>
              <th><%= t(".table.chinese_name") -%></th>
              <th><%= t(".table.position_title") -%></th>
              <th><%= t(".table.split_type") -%></th>
              <th><%= t(".table.split_rate") -%></th>
              <th><%= t(".table.split_base_number") -%></th>
              <th><%= t(".table.split_companies") -%></th>
              <th><%= t(".table.version") -%></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% @users.each do |user| %>
              <%
                scs = user.current_user_split_cost_setting
                if scs.persisted?
                  form_url = cost_split_user_split_cost_setting_path(scs)
                  buttom_text = t('.form.submit_save')
                else
                  form_url = cost_split_user_split_cost_settings_path
                  buttom_text = t('.form.submit_new')
                end
              %>
              <%= form_with model: scs, url: form_url do |f| %>
                <tr>
                  <td rowspan="3"><%= user.clerk_code -%></td>
                  <td rowspan="3"><%= user.chinese_name -%></td>
                  <td rowspan="3"><%= user.position_title -%></td>
                  <td>集团性</td>
                  <td><%= scs.group_rate -%></td>
                  <td>人数</td>
                  <td>集团所有公司列表，多选</td>
                  <td rowspan="3"><%= scs.version -%></td>
                  <td rowspan="3"><%= f.submit buttom_text, class: "btn btn-primary" -%></td>
                </tr>
                <tr>
                  <td>上海区域</td>
                  <td><%= scs.shanghai_area -%></td>
                  <td>人数</td>
                  <td>上海地区公司+有上海办事处的公司列表，多选</td>
                </tr>
                <tr>
                  <td>上海天华</td>
                  <td><%= scs.shanghai_hq -%></td>
                  <td>人数</td>
                  <td>上海天华</td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
